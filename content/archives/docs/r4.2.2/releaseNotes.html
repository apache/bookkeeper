<!DOCTYPE html>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<html>
  <head>
    <title>Apache BookKeeper - BookKeeper Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="/archives/css/bootstrap.min.css" rel="stylesheet">
    <link href="/archives/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="/archives/css/styles.css" rel="stylesheet">
  </head>
  <body>
    <header class="navbar navbar-inverse navbar-static-top" role="banner">
      <div class="container">
    	<div class="navbar-header hidden-xs hidden-sm">
    	  <a class="navbar-brand navbar-logo" href="/archives/"><img class="img-responsive" src="/archives/img/bookkeeper_blk40.png" alt="Bookkeeper Logo" /></a>
    	</div>
    	<div class="navbar-header">
    	  <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
    	  </button>
    	  <a class="navbar-brand" href="/archives/">Apache BookKeeper</a>
    	</div>
    	<nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
    	  <ul class="nav navbar-nav">
    	    <li><a href="/archives/releases.html">Download</a></li>

    	    <li class="dropdown">
    	      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Documentation<span class="caret"></span></a>
    	      <ul class="dropdown-menu" role="menu">
		<li><a href="/archives/docs/master">Latest (master)</a></li>
		<li><ul>
		    <li><a href="/archives/docs/master/apidocs">Java API docs</a></li>
		    <li><a href="/archives/docs/master/bookkeeperTutorial.html">Tutorial</a></li>
		    <li><a href="/archives/docs/master/bookkeeperConfig.html">Admin guide</a></li>
		</ul><li>
                <li><a href="/archives/docs/r4.4.0">Release 4.4.0</a></li>
                <li class="divider"></li>
                <li>Older releases</li>
                <li><a href="/archives/docs/r4.3.2">Release 4.3.2</a></li>
                <li><a href="/archives/docs/r4.3.1">Release 4.3.1</a></li>
                <li><a href="/archives/docs/r4.3.0">Release 4.3.0</a></li>
                <li><a href="/archives/docs/r4.2.4">Release 4.2.4</a></li>
                <li><a href="/archives/docs/r4.2.3">Release 4.2.3</a></li>
                <li><a href="/archives/docs/r4.2.2">Release 4.2.2</a></li>
                <li><a href="/archives/docs/r4.2.1">Release 4.2.1</a></li>
                <li><a href="/archives/docs/r4.2.0">Release 4.2.0</a></li>
                <li><a href="/archives/docs/r4.1.0">Release 4.1.0</a></li>
                <li><a href="/archives/docs/r4.0.0">Release 4.0.0</a></li>
              </ul>
            </li>
            
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Get Involved<span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="/archives/lists.html">Mailing Lists</a></li>
                <li><a href="/archives/irc.html">IRC</a></li>
                <li><a href="/archives/svn.html">Version Control</a></li>
                <li><a href="https://issues.apache.org/jira/browse/BOOKKEEPER">Issue Tracker</a></li>
              </ul>
            </li>

            <li><a href="https://cwiki.apache.org/confluence/display/BOOKKEEPER/Index">Wiki</a></li>
            <!--<li><a href="#">Hedwig</a></li>//-->
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Project Info<span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="/archives/credits.html">Who are we?</a></li>
                <li><a href="/archives/bylaws.html">Bylaws</a></li>
                <li><a href="http://www.apache.org/licenses/">License</a></li>
                <li class="divider"></li>
                <li><a href="/archives/privacy.html">Privacy Policy</a></li>
                <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsership</a></li>
                <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
              </ul>
            </li>
          </ul>
          <script>
            (function() {
            var cx = '017580107654524087317:iqnsyimpydg';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
            })();
          </script>
          
          <div class="navbar-form navbar-right visible-lg" id="googlebox">
            <gcse:searchbox-only></gcse:searchbox-only>
          </div>
        </nav>
      </div>
    </header>
    <div class="container">

 <h1>Release Notes - Bookkeeper - Version 4.2.2</h1>
    <br />
<h2>        Sub-task
</h2>
<ul>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-595'><span class="caps">BOOKKEEPER</span>-595</a>] -         Crash of inprocess autorecovery daemon should not take down the bookie
</li>
</ul>
            <br />
<h2>        Bug
</h2>
<ul>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-313'><span class="caps">BOOKKEEPER</span>-313</a>] -         Bookkeeper shutdown call from Bookie thread is not shutting down server
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-446'><span class="caps">BOOKKEEPER</span>-446</a>] -         BookKeeper.createLedger(..) should not mask the error with <span class="caps">ZKE</span>xception
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-556'><span class="caps">BOOKKEEPER</span>-556</a>] -         BookieServerMXBean#getServerState makes no sense
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-559'><span class="caps">BOOKKEEPER</span>-559</a>] -         Fix occasional failure in AuditorBookieTest
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-577'><span class="caps">BOOKKEEPER</span>-577</a>] -         BookieFailureTest uses sync/wait()/notify() incorrectly
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-579'><span class="caps">BOOKKEEPER</span>-579</a>] -         TestSubAfterCloseSub was put in a wrong package
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-580'><span class="caps">BOOKKEEPER</span>-580</a>] -         improve close logic
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-581'><span class="caps">BOOKKEEPER</span>-581</a>] -         Ledger recovery doesn&#39;t work correctly when recovery adds force changing ensembles.
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-583'><span class="caps">BOOKKEEPER</span>-583</a>] -         Read from a ReadOnlyBookie fails if index fileinfo is not in ledger cache
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-584'><span class="caps">BOOKKEEPER</span>-584</a>] -         Data loss when ledger metadata is overwritten
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-585'><span class="caps">BOOKKEEPER</span>-585</a>] -         Auditor logs noisily when a ledger has been deleted
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-596'><span class="caps">BOOKKEEPER</span>-596</a>] -         Ledgers are gc&#39;ed by mistake in <span class="caps">MSL</span>edgerManagerFactory.
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-598'><span class="caps">BOOKKEEPER</span>-598</a>] -         Fails to compile - <span class="caps">RESUBSCRIBE</span>_EXCEPTION conflict
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-600'><span class="caps">BOOKKEEPER</span>-600</a>] -         shouldClaim flag isn&#39;t cleared for hedwig multiplex java client
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-601'><span class="caps">BOOKKEEPER</span>-601</a>] -         readahead cache size isn&#39;t updated correctly 
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-603'><span class="caps">BOOKKEEPER</span>-603</a>] -         Support Boost 1.53 for Hedwig Cpp Client
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-604'><span class="caps">BOOKKEEPER</span>-604</a>] -         Ledger storage can log an exception if GC happens concurrently.
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-607'><span class="caps">BOOKKEEPER</span>-607</a>] -         Filtered Messages Require <span class="caps">ACK </span>from Client Causes User Being Throttled Incorrectly Forever
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-619'><span class="caps">BOOKKEEPER</span>-619</a>] -         Bookie should not create local cookie files if zookeeper is uninitialized
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-620'><span class="caps">BOOKKEEPER</span>-620</a>] -         PerChannelBookieClient race during channel disconnect
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-621'><span class="caps">BOOKKEEPER</span>-621</a>] -         <span class="caps">NPE </span>in FileInfo.moveToNewLocation
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-623'><span class="caps">BOOKKEEPER</span>-623</a>] -         LedgerChecker should avoid segments of closed ledger with higher start entryId than closed entry.
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-624'><span class="caps">BOOKKEEPER</span>-624</a>] -         Reduce logs generated by ReplicationWorker
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-625'><span class="caps">BOOKKEEPER</span>-625</a>] -         On OutOfMemoryError in <span class="caps">NIOS</span>erverFactory thread bookie should shutdown
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-626'><span class="caps">BOOKKEEPER</span>-626</a>] -         <span class="caps">BOOKIE</span>_EXTRA_OPTS are added twice
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-632'><span class="caps">BOOKKEEPER</span>-632</a>] -         AutoRecovery should consider read only bookies
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-635'><span class="caps">BOOKKEEPER</span>-635</a>] -         jenkins build should highlight which lines of the patch cause raw analysis errors
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-636'><span class="caps">BOOKKEEPER</span>-636</a>] -         Latest txn logs might be deleted in a race condition which is not recoverable if BK goes down before next txn log created.
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-642'><span class="caps">BOOKKEEPER</span>-642</a>] -         Bookie returns incorrect exitcode, ExitCode.ZK_REG_FAIL is getting overridden
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-646'><span class="caps">BOOKKEEPER</span>-646</a>] -         BookieShell readjournal command is throwing BufferUnderflowException
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-649'><span class="caps">BOOKKEEPER</span>-649</a>] -         Race condition in sync <span class="caps">ZKU</span>tils.createFullPathOptimistic()
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-652'><span class="caps">BOOKKEEPER</span>-652</a>] -         Logger class name is wrong in LedgerCacheImpl.java
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-660'><span class="caps">BOOKKEEPER</span>-660</a>] -         Logs too noisy on <span class="caps">NIOS</span>erverFactory when client drops a connection
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-663'><span class="caps">BOOKKEEPER</span>-663</a>] -         HierarchicalLedgerManager iterator is missing some ranges and the last ledger in the range
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-664'><span class="caps">BOOKKEEPER</span>-664</a>] -         Compaction increases latency on journal writes
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-667'><span class="caps">BOOKKEEPER</span>-667</a>] -         Client write will fail with BadMetadataVersion in case of multiple Bookie failures with AutoRecovery enabled
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-668'><span class="caps">BOOKKEEPER</span>-668</a>] -         Race between PerChannelBookieClient#channelDisconnected() and disconnect() calls can make clients hang while add/reading entries in case of multiple bookie failures
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-669'><span class="caps">BOOKKEEPER</span>-669</a>] -         Race condition in ledger deletion and eviction from cache
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-679'><span class="caps">BOOKKEEPER</span>-679</a>] -         Bookie should exit with non-zero if <span class="caps">NIOS</span>erver crashes with Error
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-683'><span class="caps">BOOKKEEPER</span>-683</a>] -         TestSubAfterCloseSub fails on 4.2
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-684'><span class="caps">BOOKKEEPER</span>-684</a>] -         ZK logging is oververbose, can cause oom in tests
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-685'><span class="caps">BOOKKEEPER</span>-685</a>] -         Race in compaction algorithm from <span class="caps">BOOKKEEPER</span>-664
</li>
</ul>
                <br />
<h2>        Improvement
</h2>
<ul>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-618'><span class="caps">BOOKKEEPER</span>-618</a>] -         Better resolution of bookie address
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-627'><span class="caps">BOOKKEEPER</span>-627</a>] -         LedgerDirsMonitor is missing thread name
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-637'><span class="caps">BOOKKEEPER</span>-637</a>] -         NoSuchEntry exception when reading an entry from a bookie should not print <span class="caps">ERROR </span>level message
</li>
</ul>
    <br />
<h2>        New Feature
</h2>
<ul>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-257'><span class="caps">BOOKKEEPER</span>-257</a>] -         Ability to list all ledgers
</li>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-562'><span class="caps">BOOKKEEPER</span>-562</a>] -         Ability to tell if a ledger is closed or not
</li>
</ul>
                                            <br />
<h2>        Wish
</h2>
<ul>
<li>[<a href='https://issues.apache.org/jira/browse/BOOKKEEPER-675'><span class="caps">BOOKKEEPER</span>-675</a>] -         Log noise fixup before cutting 4.2.2
</li>
</ul>
                                                         

    </div>
    <footer class="footer">
      <div class="container">
        <p class="text-muted">Copyright &copy; 2014 The Apache Software Foundation, Licensed under the Apache License, Version 2.0.<br/>
	Apache BookKeeper, BookKeeper, Apache, Apache ZooKeeper, ZooKeeper, the Apache feather logo, and the Apache BookKeeper project logo are trademarks of The Apache Software Foundation.</p>
      </div>
    </footer>

    <script src="//code.jquery.com/jquery.js"></script>
    <script src="/archives/js/bootstrap.min.js"></script>
  </body>
</html>
