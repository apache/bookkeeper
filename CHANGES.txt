Trunk

Non-backward compatible changes:

BUGFIXES:

Backward compatible changes:

BUGFIXES:

 bookkeeper-server/

  BOOKKEEPER-1: Static variable makes tests fail (fpj via ivank)

  BOOKKEEPER-19: BookKeeper doesn't support more than 2Gig of memory (ivan via fpj)

  BOOKEEPER-22: Exception in LedgerCache causes addEntry request to fail (fpj via fpj)

  BOOKEEPER-5: Issue with Netty in BookKeeper (fpj and ivank via fpj)

  BOOKKEEPER-30: Test are too noisy (ivank via fpj)

  BOOKKEEPER-11: Read from open ledger (fpj via ivank)

  BOOKKEEPER-27: mvn site failed with unresolved dependencies (ivank via fpj)
  
  BOOKKEEPER-29: BookieRecoveryTest fails intermittently (fpj via ivank)

  BOOKKEEPER-33: Add length and offset parameter to addEntry (ivank via fpj)

  BOOKKEEPER-29: BookieRecoveryTest fails intermittently (ivank, fpj via fpj)

  BOOKKEEPER-38: Bookie Server doesn't exit when its zookeeper session is expired. So the process is hang there. (Sijie Guo via breed)

  BOOKKEEPER-58: Changes introduced in BK-38 cause BookieClientTest to hang indefinitely. (ivank)

  BOOKKEEPER-18: maven build is unstable (mmorel, ivank via ivank)

  BOOKKEEPER-57: NullPointException at bookie.zk@EntryLogger (xulei via ivank)

  BOOKKEEPER-59: Race condition in netty code allocates and orphans resources (BK-5 revisited) (ivank via fpj)
  
  BOOKKEEPER-68: Conditional setData (fpj via ivank)

  BOOKKEEPER-86: bookkeeper-benchmark fails to compile after BOOKKEEPER-68 (ivank via breed)

  BOOKKEEPER-61: BufferedChannel read endless when the remaining bytes of file is less than the capacity of read buffer (Sijie Guo via breed)

  BOOKKEEPER-84: Add versioning for ZK metadata (ivank via breed)

  BOOKKEEPER-92: using wrong context object in readLastConfirmedComplete callback (Sijie Guo via ivank)
 
  BOOKKEEPER-94: Double callbacks in readLastConfirmedOp which fails readLastConfirmed operation even received enough valid responses. (Sijie Guo via ivank)

  BOOKKEEPER-83: Added versioning and flags to the bookie protocol (ivank)

  BOOKKEEPER-89: Bookkeeper API changes for initial Bookkeeper release (ivank)

  BOOKKEEPER-93: bookkeeper doesn't work correctly on OpenLedgerNoRecovery (Sijie Guo via ivank)

 hedwig-server/

  BOOKKEEPER-43: NullPointException when releasing topic (Sijie Guo via breed)
  
  BOOKKEEPER-51: NullPointException at FIFODeliveryManager#deliveryPtrs (xulei via ivank)

  BOOKKEEPER-63: Hedwig PubSubServer must wait for its Zookeeper client to be connected upon startup (mmorel via ivank)

 hedwig-client/
 
  BOOKKEEPER-52: Message sequence confuse due to the subscribeMsgQueue@SubscribeResponseHandler (xulei via ivank)

  BOOKKEEPER-88: derby doesn't like - in the topic names (breed via ivank)

IMPROVEMENTS:

 BOOKKEEPER-28: Create useful startup scripts for bookkeeper and hedwig (ivank)

 BOOKKEEPER-26: Indentation is all messed up in the BookKeeper code (ivank via fpj)

 BOOKKEEPER-41: Generation of packages for distribution (ivank via fpj)

 BOOKKEEPER-65: fix dependencies on incompatible versions of netty (mmorel via ivank)

 hedwig-client/

  BOOKKEEPER-44: Reuse publish channel to default server to avoid too many connect requests to default server when lots of producers came in same time (Sijie Guo via breed)
